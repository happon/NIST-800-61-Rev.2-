# インシデントのハンドリング

インシデント対応プロセスにはいくつかの段階があります。最初の段階では、インシデント対応チームの設立と訓練、必要なツールとリソースの獲得が含まれます。準備期間中、組織は、また、リスク評価の結果に基づいて一連の管理策を選択して実施することで、発生するインシデントの数を制限しようします。しかし対策を実施した後も、残留リスクは確実に存在します。そのため、インシデントが発生した際に組織に注意を喚起するためには、セキュリティ侵害を検知することが必要です。インシデントの深刻度に応じて、組織は、インシデントを抑制し、最終的にインシデントから回復することで、インシデントの影響を軽減することができます。このフェーズでは、マルウェアインシデントを根絶している間に、追加のホストがマルウェアに感染していないかどうかを確認するなど、検出と分析に活動が戻ることがよくあります。インシデントが適切に処理された後、組織は、インシデントの原因とコスト、および将来のインシデントを防止するために組織が取るべき手順を詳細に記載した報告書を発行します。このセクションでは、インシデント対応プロセスの主要なフェーズである、準備、検出と分析、封じ込め、根絶と回復、およびインシデント後の活動について詳細に説明します。図 3-1 は、インシデント対応のライフサイクルを示しています。  
<img src="https://github.com/happon/figureRepository/blob/master/figure3-1.jpg" alt="図3-1" title="図3-1" width="480" height="320">

<br/>

### 3.1 準備

インシデント対応の方法論は、一般的に準備を重視しています。すなわち、組織がインシデントに対応できるようにインシデント対応能力を確立するだけでなく、システ ム、ネットワーク、およびアプリケーションの安全性を十分に確保することでインシデントを防止するのです。インシデント対応チームは、通常、インシデント予防の責任者ではありませんが、インシデント対応プログラムを成功させるための基本的な役割を担っています。このセクションでは、インシデントへの対応準備とインシデントの予防に関する基本的なアドバイスを提供します。 
 
<br/>

#### 3.1.1 インシデントハンドリングの準備

以下のリストは、インシデントハンドリング中に価値があると思われる利用可能なツールとリソースの例を提供しています。これらのリストは、組織のインシデント・ハンドラーがどのようなツールやリソースを必要としているかを議論するための出発点となることを意図しています。例えば、スマートフォンは、回復力のある緊急通信と調整メカニズムを持つための一つの方法です。組織は、1つのメカニズムが故障した場合に備えて、複数の（別々の、異なる）通信および調整メカニズムを持つべきです。 


##### インシデントハンドラーの通信と設備について  
 
■ チームメンバー、および法執行機関やその他のインシデント対応チームなど、組織内外のその他の人（プライマリーコンタクトおよびバックアップコンタクト）の**連絡先情報** (電話番号、電子メールアドレス、公開暗号化キー（以下に説明する暗号化ソフトウェアに準拠）、および連絡先の身元を確認するための指示などが含まれます。)  
 
■ エスカレーション情報を含む組織内の他チームの**オンコール情報**

■ 電話番号、電子メールアドレス、オンラインフォーム、ユーザーが疑わしいインシデントを報告するために使用できる安全なインスタントメッセージングシステムなどの**インシデント報告メカニズム**。

■ インシデント情報やステータスなどを追跡するための、**問題追跡システム**

■ 時間外のサポートや現場でのコミュニケーションのために、チームメンバーが携帯する**スマートフォン**

■ **暗号化ソフトウェア**は、チームメンバー間、組織内、および外部の関係者との通信に使用されるもので、連邦政府機関の場合、ソフトウェアはFIPS140-2認証済みの暗号化アルゴリズムを使用する必要があります。

■ 連絡調整のための**作戦室**。常設の作戦室が必要ない場合や現実的でない場合は、チームは必要に応じて一時的な戦闘室を調達するための手順を作成すべきです。 

■ 証拠品などの機密性の高いものを確保するための**安全な保管手段**  

<br/>

##### インシデント分析のハードウェアとソフトウェア

■ ディスクイメージを作成し、ログファイルを保存し、その他の関連するインシデントデータを保存するための**デジタル・フォレンジック・ ワークステーション※１ および/またはバックアップ装置**  
※１ デジタル・フォレンジック・ワークステーションは、インシデント・ハンドラーがデータを取得して分析するのを支援するために特別に設計されています。これらのワークステーションには、通常、証拠保管に使用できるリムーバブルハードドライブのセットが含まれています。  

■ データ分析、パケットの盗聴、レポート作成などの活動に使用する**ノートパソコン**

■ **ワークステーション、サーバ、ネットワーク機器**、または仮想化されたものをスペアとして、バックアップの復元やマルウェアの試用など、様々な目的で使用できます。 

■ **空のリムーバブルディスク**

■ ネットワークに接続されていないシステムからログファイルなどの証拠品のコピーを印刷するための**携帯型プリンタ**

■ ネットワークトラフィックをキャプチャして分析するための**パケットスニファーとプロトコルアナライザ**

■ ディスクイメージを解析する**デジタルフォレンジックソフトウェア**

■ 信頼のおけるバージョンのプログラムを入れておき、システムから証拠を集める際に使用する**リムーバブルメディア**

■ **証拠収集アクセサリー**：法的行動の可能性に備えて証拠を残しておくための、堅表紙のノート、デジタルカメラ、オーディオレコーダー、書類・証拠の受け渡し記録フォーム、証拠保管バッグとタグ、証拠テープなど。

<br/>

##### インシデント分析リソース

■ 一般に使用されるポートとトロイの木馬のポートの**ポートリスト**

■ OS、アプリケーション、プロトコル、侵入検知とアンチウイルスシグネチャなどの**ドキュメント**

■ **ネットワーク図と重要な資産の一覧**  
例）データベースサーバー

■ 期待されるネットワーク、システム、アプリケーションの活動の現在の**基準**  

■ インシデントの分析、検証、および撲滅を迅速に行うための重要ファイルの**暗号化ハッシュ**

<br/>

##### インシデント軽減ソフトウェア  

■ 復元やリカバリーのためのクリーンなOSやアプリケーションのインストールイメージへのアクセス

多くのインシデント対応チームは、調査中に必要となる可能性のある資材が入った携帯用ケースであるジャンプキットを作成しています。ジャンプキットは、いつでも持ち運べるようにしておく必要があります。ジャンプキットには、上記の箇条書きのリストに記載されているものと同じものが多く含まれています。例えば、各ジャンプキットには通常、適切なソフトウェア（例：パケットスニッファー、デジタルフォレンジック）を搭載したノートパソコンが含まれています。その他の重要な材料には、バックアップデバイス、ブランクメディア、および基本的なネットワーク機器とケーブルが含まれています。ジャンプキットを持つ目的は、迅速な対応を容易にすることですので、チームはジャンプキットからのアイテムの借用を避けるべきです。 

各インシデント担当者は、少なくとも2台のコンピューティングデバイス（ノートパソコンなど）にアクセスできるようにしておくべきです。1台は、ジャンプキットからのものなど、パケットスニッフィング、マルウェア解析、およびそれらを実行するノートパソコンを汚染する危険性のあるその他のすべてのアクションを実行するために使用してください。このノートパソコンは、別のインシデントに使用する前に、スクラブし、すべてのソフトウェアを再インストールする必要があります。このノートパソコンは特別な目的のため、標準的なエンタープライズツールや設定以外のソフトウェアを使用する可能性が高いことに注意してください。調査用ノートパソコンに加えて、各インシデントハンドラーは、報告書を書いたり、電子メールを読んだり、実地でのインシデント分析とは無関係の他の業務を行ったりするために、標準的なノートパソコン、スマートフォン、または他のコンピューティングデバイスを持っているべきです。 
 
模擬インシデントを含む演習も、インシデントハンドリングのためのスタッフの準備に非常に有用です。演習※の詳細についてはNIST SP 800-84を、演習シナリオのサンプルについては付録Aを参照してください。
※ IT計画およびIT対応能力のためのテスト、トレーニング、演習プログラムのガイド http://csrc.nist.gov/publications/PubsSPs.html#800-84  
 
<br/>

#### 3.1.2 インシデントの予防

組織のビジネスプロセスを保護するためには、インシデントの数を適度に少なくすることが非常に重要です。セキュリティ管理が不十分な場合、インシデントが大量に発生し、インシデント対応チームを圧倒する可能性があります。その結果、対応に時間がかかったり、不完全なものになったりして、ビジネスへの悪影響が大きくなる可能性があります（例：被害の拡大、サービスの長期化、データの利用不能など）。  

ネットワーク、システム、およびアプリケーションのセキュリティ確保に関する具体的なアドバイスを提供することは、この文書の範囲外です。インシデント対応チームは、一般的にリソースの安全確保には責任を負いませんが、健全なセキュリティ対策の提唱者となり得ます。インシデント対応チームは、組織が他の方法では気付かない問題を特定できる可能性があります。インシデント対応チームは、ギャップを特定することで、リスク評価と訓練において重要な役割を果たすことができます。他の文書では、一般的なセキュリティの概念や、オペレーティングシステムやアプリケーションに特化したガイドラインについてのアドバイスがすでに提供されています※。しかし、以下に、ネットワーク、システム、およびアプリケーションのセキュリティを確保するために推奨されている主な実践方法の概要について簡単に説明します。  

※ http://csrc.nist.gov/publications/PubsSPs.html は、コンピュータセキュリティに関する NIST の特別出版物へのリンクを提供しています。

<br/>
 
■ **リスク評価**  
システムとアプリケーションの定期的なリスク評価は、脅威と脆弱性の組み合わせによってどのようなリスクが引き起こされているかを判断するべきです※１。これには、組織固有の脅威を含め、適用可能な脅威を理解することが含まれます。それぞれのリスクには優先順位をつけ、リスクの全体的な合理的なレベルに達するまで、リスクを軽減、移転、受容することができます。定期的にリスクアセスメントを実施するもう一つの利点は、重要な資源が特定され、スタッフはそれらの資源に対する監視と対応活動に重点を置くことができるという点です※２。 

※１ リスク評価に関するガイドラインは、NIST SP 800-30, リスクアセスメントの実施の手引きhttp://csrc.nist.gov/publications/PubsSPs.html#800-30-Rev1 に掲載されています。 

※２ クリティカルなリソースの特定に関する情報は、FIPS 199「連邦情報および情報システムのセキュリティ分類基準」（http://csrc.nist.gov/publications/PubsFIPS.html）で議論されています。
  
<br/>

■ **ホストセキュリティ**  
すべてのホストは、標準的な設定を用いて適切にセキュリティを強化する必要があります。各ホストのパッチを適切に適用することに加えて、権限のあるタスクを実行するために必要な権限のみをユーザに付与するという原則に従うように設定されている必要があります。監査を有効にし、セキュリティ関連の重要なイベントをログに記録しなければなりません。ホストとその設定のセキュリティを継続的に監視する必要があります※３。多くの組織は、一貫して効果的にホストのセキュリティを確保するために、Security Content Automation Protocol (SCAP)※４ で表現されたオペレーティングシステムとアプリケーションの設定チェックリストを使用しています※５。
 
※３ 継続的監視の詳細については、NIST SP 800-137 「連邦政府の情報システムと組織のための情報セキュリティの継続的な監視」(http://csrc.nist.gov/publications/PubsSPs.html#800-137)を参照してください。  

※４ SCAP の詳細については、NIST SP 800-117 Revision 1, 「セキュリティ・コンテンツ・オートメーション・プロトコル(SCAP)の採用と使用の手引き」Version 1.2 (http://csrc.nist.gov/publications/PubsSPs.html#800-117) を参照してください。

※５ NIST はセキュリティチェックリストのリポジトリを http://checklists.nist.gov/ で公開しています。  
 
■ **ネットワークセキュリティ**  
ネットワークの境界は、明示的に許可されていないすべてのアクティビティを拒否するように設定する必要があります。これには、仮想プライベート ネットワーク (VPN) や他の組織への専用接続など、すべての接続ポイントのセキュリティを確保することが含まれます。

■ **マルウェアの予防**  
マルウェアを検出して停止させるためのソフトウェアは、組織全体に配備されている必要があります。マルウェア対策は、ホストレベル（サーバやワークステーションのオペレーテ ィングシステムなど）、アプリケーションサーバレベル（電子メールサーバ、ウェブプロキシなど）、アプリケーションクライアントレベル（電子メールクライアント、インスタントメッセージングクライアントなど）で展開する必要があります。
 
■ **ユーザーの意識向上とトレーニング**  
ネットワーク、システムおよびアプリケーションの適切な使用に関するポリシー・手順をユーザーに周知すべきです。また、過去のインシデントから得られた適用可能な教訓をユーザーと共有し、自分たちの行動が組織にどのような影響を与えるかを確認できるようにする必要があります。インシデントに関するユーザの意識を向上させることで、インシデントの頻度を減らすことができます。IT スタッフは、組織のセキュリティ基準に従ってネットワーク、システム、およびアプリケーションを維持できるように訓練を受けるべきです。 
 
<br/> 
 
## 3.2 検出と分析

#### 3.2.1 攻撃手法
インシデントは無数の方法で発生する可能性があるため、すべてのインシデントに対処するためのひとつひとつの手順書を作成することは不可能です。組織は、一般的にどのようなインシデントにも対応できるように準備しておくべきですが、一般的な攻撃手法を使用するインシデントに対応できるように準備することに重点を置くべきです。異なるタイプのインシデントには、異なる対応戦略が必要です。以下に挙げた攻撃手法は、インシデントの決定的な分類を提供することを意図したものではありません。むしろ、これらは単に一般的な攻撃方法を列挙したものであり、より具体的な対処方法を定義するための基礎として利用することができます。  
 
■ **外部／リムーバブルメディア**  
リムーバブルメディアや周辺機器（例えば、感染したUSBフラッシュドライブからシステムに拡散する悪意のあるコードなど）から実行される攻撃。 

■ **消耗**  
システム、ネットワーク、またはサービスを危殆化、劣化、または破壊するために、ブルートフォースの手法を用いた攻撃 (例: サービスやアプリケーションへのアクセスを妨害または拒否することを目的とした DDoS、パスワード、CAPTCHAS、デジタル署名などの認証メカニズムに対するブルートフォース攻撃)。 

■ **ウェブ**  
WebサイトやWebベースのアプリケーションから実行される攻撃。例えば、資格情報を盗むために使用されるクロスサイトスクリプティング攻撃や、ブラウザの脆弱性を突いてマルウェアをインストールするサイトへのリダイレクトなどが挙げられます。 

■ **Eメール**  
メールメッセージや添付ファイルを介して実行される攻撃。例えば、添付文書を装ったエクスプロイトコードや、メールメッセージの本文にある悪意のあるウェブサイトへのリンクなどが挙げられます。

■ **なりすまし**  
善良なものを悪意のあるものに置き換える攻撃。例えば、なりすまし、中間者攻撃、不正な無線アクセスポイント、SQLインジェクション攻撃などは、すべてなりすましを伴います。

■ **不適切な使用**  
認可されたユーザーによる組織の許容される利用ポリシーの違反に起因するすべてのインシデント（上記のカテゴリーを除く）。例えば、ユーザーがファイル共有ソフトウェアをインストールして機密データの損失を招いた場合、またはユーザーがシステム上で違法行為を行った場合。 

■ **機器の紛失または盗難**  
ノートパソコン、スマートフォン、認証トークンなど、組織が使用しているコンピューティングデバイスやメディアの紛失や盗難。

■ **その他**  
上のどのカテゴリーにも当てはまらない攻撃。



このセクションでは、あらゆるタイプのインシデントに対処するための推奨される実践方法に焦点を当てています。攻撃手法に基づいた具体的なアドバイスの提供は、この出版物の範囲外です。このようなガイドラインは、マルウェアのインシデント予防と処理に関するNIST SP 800-83のような、他のインシデント処理のトピックを扱う別の出版物で提供されます。
 
<br/>

#### 3.2.2 インシデントの兆候
多くの組織にとって、インシデント対応プロセスの中で最も困難な部分は、インシデントの可能性を正確に検出して評価することであり、インシデントが発生したかどうか、発生した場合には問題の種類、程度、および大きさを判断することです。これを困難にしているのは、3つの要因が重なっているからです。  

■ インシデントは、詳細さと正確性が異なるさまざまな方法で検出される可能性があります。自動検出機能には、ネットワークベースおよびホストベースの IDPS、ウイルス対策ソフト、ログアナライザなどがあります。インシデントは、ユーザーから報告された問題などの手動の手段によっても検出されることがあります。インシデントの中には、簡単に検出できる明白な兆候があるものもあれば、ほとんど検出できないものもあります。 
 
■ インシデントの潜在的な兆候の量は一般的に多く、例えば、組織が一日に何千、何百万もの侵入検知センサーのアラートを受信することも珍しくありません。（このようなアラートの分析に関する情報については、セクション 3.2.4 を参照）  

■ インシデント関連データを適切かつ効率的に分析するためには、深く専門的な技術知識と豊富な経験が必要です。

インシデントの兆候は、「前兆」と「兆候」という2つのカテゴリーのどちらかに分類されます。兆候とは、インシデントが発生した可能性がある、または現在発生している可能性があることを示すサインです。 
  
ほとんどの攻撃は、ターゲットから見れば、識別可能な前兆や検出可能な前兆を持っていません。前兆が検出された場合、組織は、攻撃からターゲットを救うためにセキュリティ姿勢を変更することで、インシデントを防止する機会があるかもしれません。最低限、組織はターゲットが関与する活動をより綿密に監視することができます。前兆の例としては、以下のようなものがあります。
 
■ 脆弱性スキャナの使用状況を示すウェブサーバのログエントリ
 
■ 組織のメールサーバの脆弱性を標的とした新たなエクスプロイトの発表  

■ 組織を攻撃すると表明した集団からの脅迫

<br/>

前兆は比較的まれですが、兆候はとてもありふれています。兆候の種類が多すぎてリストアップしきれませんが、以下にいくつかの例を挙げます。 
 
■ ネットワーク侵入検知センサによるデータベースサーバに対してバッファオーバーフロー発生の警告 

■ アンチウイルスソフトによるホストのマルウェア感染検出の警告

■ システム管理者によるファイル名に異常な文字が含まれていることへの警告 

■ ホストのログに、監査設定の変更が記録される。  

■ アプリケーションによる見慣れないリモートシステムからの複数ログイン失敗をログに記録される。

■ 電子メール管理者が、不審な内容の電子メールが大量の配信エラー（バウンスメール）を見つける。 

■ ネットワーク管理者が、典型的なネットワークトラフィックフローからの異常な逸脱に気づく。  

<br/>

#### 3.2.3 前兆と兆候のソース
前兆と兆候は、多くの異なるソースを使用して特定されますが、最も一般的なものは、コンピュータセキュリティソフトウェアの警告、ログ、公開されている情報及び人です。表 3-2 に、各カテゴリの前兆と兆候の一般的なソースを示します。  

**アラート**  
|ソース     | 説　明   |  
|-|-|
|侵入検知・防止システム<br/>(IDPS)|IDPS 製品は不審なイベントを識別し、攻撃が検出された日時、攻撃の種類、送信元と送信先の IP アドレス、ユーザー名（該当する場合は既知のもの）など、不審なイベントに関する関連データを記録します。ほとんどのIDPS製品では、攻撃シグネチャを使用して悪意のある活動を識別しています。最新の攻撃を検出できるように、シグネチャを常に最新の状態に保つ必要があります。IDPSソフトウェアは、悪意のある活動が発生していることを示す偽のポジティブアラートを生成しますが、実際には何も発生していないことがしばしばあります。アナリストは、記録されたサポートデータを精査するか、他のソースから関連データを入手してIDPSアラートを手動で検証する必要があります。|
|シーム<br/>(SIEM)|セキュリティ情報・イベント管理（SIEM）製品はIDPS製品と似ていますが、ログデータの分析に基づいてアラートを生成します（後述）。 |
|ウイルス対策およびアンチスパムソフトウェア|ウイルス対策ソフトは、様々な形態のマルウェアを検出し、アラートを生成し、マルウェアがホストに感染するのを防ぎます。現在のウイルス対策製品は、マルウェアのシグネチャが最新の状態に保たれていれば、多くのマルウェアのインスタンスを停止させる効果があります。スパム対策ソフトは、スパムを検出し、ユーザーのメールボックスに届かないようにします。スパムにはマルウェアやフィッシング攻撃、その他の悪質なコンテンツが含まれている可能性があるため、スパム対策ソフトからの警告は攻撃の企図を示している可能性があります。|
|ファイル完全性チェックソフトウェア|ファイル完全性チェックソフトウェアは、インシデント時に重要なファイルに加えられた変更を検出することができます。ハッシュアルゴリズムを使用して、指定された各ファイルの暗号チェックサムを取得します。ファイルが変更され、チェックサムが再計算された場合、新しいチェックサムが古いチェックサムと一致しない可能性が非常に高くなります。定期的にチェックサムを再計算し、以前の値と比較することで、ファイルの変更を検出することができます。|
|サードパーティによるモニタリングサービス|サードパーティは、サブスクリプションベースの様々な無料モニタリングサービスを提供しています。例えば、IPアドレスやドメイン名などが他の組織が関与する現在のインシデント活動に関連している時に、組織に通知する不正検知サービスがあります似たような情報を持つ無料のリアルタイムブラックリストもあります。サードパーティ監視サービスのもう一つの例として、CSIRCの通知リストがあります。これらのリストは、他のインシデント対応チームのみが利用できることが多いです。|

**ロ グ**  
|ソース     | 説　明   |  
|-|-|
|OS,サービス及びアプリケーションのログ |オペレーティングシステム、サービス、およびアプリケーションからのログ（特に監査関連データ）は、インシデントが発生した際に、どのアカウントにアクセスしたか、どのようなアクションが実行されたかを記録するなど、非常に価値のあるものであることが多いです。組織は、すべてのシステムでログ取得の基準レベルが必要で、重要なシステムではより高い基準レベルにします。ログは、イベント情報を関連付けて分析に使用することができます。イベント情報に応じて、インシデントを示すアラートを生成することができます。3.2.4節では、集中ログの価値について述べています。|
|ネットワークデバイスのログ|ファイアウォールやルータなどのネットワークデバイスからのログは、通常、前兆や兆候の主要なソースではありません。これらのデバイスは通常、ブロックされた接続試行をログに記録するように設定されていますが、アクティビティの性質に関する情報はほとんど得られません。しかし、ネットワークの傾向を特定したり、他のデバイスで検出されたイベントを関連付けたりする上では貴重な情報となります。|
|ネットワークフロー|ネットワークフローとは、ホスト間で発生する特定の通信セッションのことです。ルータやその他のネットワーク機器は、ネットワークフロー情報を提供することができ、マルウェアやデータの流出、その他の悪意のある行為によって引き起こされる異常なネットワークアクティビティを見つけるために使用することができます。フローデータのフォーマットには、NetFlow、sFlow、IPFIXなど多くの標準があります。|

**公に入手可能な情報**  
|Source ソース     | Description 説　明   |  
|-|-|
|新しい脆弱性やエクスプロイトに関する情報|新しい脆弱性とその悪用を常に把握しておくことは、いくつかのインシデントの発生を防ぎ、新たな攻撃の検出と分析に役立てることができます。US-CERT33 や CERT®/CC などの組織は、ブリーフィング、ウェブ投稿、およびメーリングリストを通じて、脅威の更新情報を定期的に提供しています。|

**人**
|Source ソース     | Description 説　明   |  
|-|-|
|組織内の人々|ユーザー、システム管理者、ネットワーク管理者、セキュリティ担当者、および組織内のその他の者が、インシデントの兆候を報告することがあります。そのような報告をすべて検証することが重要です。情報を提供した人に、その情報の正確さにどの程度の自信があるかを尋ねるのも一つの方法です。この推定値を提供された情報と一緒に記録しておくと、インシデント分析の際に、特に矛盾するデータが発見された場合に、かなり役立ちます。| 
|組織外の人々|外部から発生したインシデントの報告は、真摯に受け止めるべきです。 例えば、組織のシステムが攻撃されていると主張する者から組織に連絡が来るかもしれません。外部ユーザーは、改ざんされたウェブページや利用できないサービスなど、他の兆候を報告することもあります。他のインシデント対応チームもインシデントを報告することがあります。外部の関係者が兆候を報告するための仕組みを用意し、訓練を受けたスタッフがそれらの仕組みを注意深く監視することが重要です。これは、ヘルプデスクにメッセージを転送するように設定された電話番号と電子メールアドレスを設定するのと同じくらい簡単なことかもしれません。|  

<br/>

### 3.2.4 インシデント分析
すべての前兆や兆候が正確であることが保証されていれば、インシデントの検出や分析は簡単です。しかし、残念ながらそうではありません。例えば、サーバーが利用できないという苦情など、ユーザーが提供した兆候が正しくないことがよくあります。侵入検知システムは、誤ったポジティブ、つまり不正確な兆候を生成することがあります。これらの例は、インシデントの検出と分析を困難にしていることを示しています。理想的には、それぞれの指標は、その正確性を判断するために評価されなければなりません。さらに悪いことに、兆候の総数は1日に何千、何百万ということもあります。すべての兆候の中から実際に発生したセキュリティインシデントを見つけるのは、大変な作業になります。

また、兆候が正確であったとしても、必ずしもインシデントが発生したとは限りません。サーバーのクラッシュや重要なファイルの変更など、いくつかの兆候の中には、人為的なミスなど、セキュリティインシデント以外のいくつかの理由で発生する可能性があります。しかし、兆候が発生していれば、インシデントが発生しているかもしれないと疑い、それに応じて行動することは理にかなっています。特定の事象が実際にインシデントであるかどうかの判断は、時に判断の問題となります。判断を下すために、他の技術担当者や情報セキュリティ担当者と協力することが必要な場合もあります。多くの場合、状況がセキュリティ関連であるかどうかに関係なく、同じ方法で処理されるべきです。例えば、ある組織でインターネット接続が12時間ごとに失われ、誰も原因がわからない場合、スタッフは同じように迅速に問題を解決したいと考え、原因に関係なく同じリソースを使って問題を診断することになるでしょう。  

インシデントの中には、明らかに改ざんされたウェブページなど、検出しやすいものもあります。しかし、多くのインシデントは、そのような明確な症状とは関連していません。システム構成ファイルの変更のような小さな兆候だけが、インシデントが発生したことを示す唯一の兆候かもしれません。インシデントハンドリングでは、検出が最も困難な作業かもしれません。インシデントハンドラーは、何が起こったのかを判断するために、曖昧で、矛盾した、不完全な症状を分析する責任があります。検出を容易にする技術的な解決策は存在しますが、最良の解決策は、前兆や兆候を効果的かつ効率的に分析し、適切な行動をとることができる、経験豊富で熟練したスタッフのチームを構築することです。十分な訓練を受けた有能なスタッフがいなければ、インシデントの検出と分析は非効率的に行われ、コストのかかるミスを犯すことになります。  
  
インシデント対応チームは、事前に定義されたプロセスに従って、各インシデントの分析と検証を迅速に行 い、各ステップを文書化する必要があります。インシデントが発生したとチームが判断した場合、チームは迅速に初期分析を行い、どのネットワーク、システム、またはアプリケーションが影響を受けるのかなど、インシデントの範囲を決定する必要があります。インシデントが発生したのは誰なのか、何が原因なのか、インシデントがどのように発生しているのか（どのようなツールや攻撃方法が使用されているのか、どのような脆弱性が悪用されているのかなど）。初期分析は、インシデントの封じ込めやより深いインシデントの影響分析など、チームがその後の活動に優先順位をつけるのに十分な情報を提供しなければなりません。 

初期分析と検証を行うことは困難です。以下は、インシデント分析をより簡単で効果的なものにするための推奨事項です。
 
■ **正常な動作を理解する**  
インシデント対応チームのメンバーは、ネットワーク、システム、およびアプリケーションを研究し、異常な動作をより簡単に認識できるように、その正常な動作を理解する必要があります。インシデントハンドラーは、環境全体のすべての行動について包括的な知識を持っているわけではありませんが、どの専門家がそのギャップを埋めることができるかを知っておく必要があります。この知識を得るための一つの方法は、ログエントリとセキュリティアラートを確認することです。これは、ログを適切なサイズに凝縮するためのフィルタリングが使用されていない場合、退屈な作業になるかもしれません。ハンドラーがログやアラートに慣れてくると、原因不明のエントリに焦点を当てることができるようになり、通常は調査することがより重要になります。頻繁にログのレビューを行うことで、知識を新鮮なものに保つことができ、分析者は時間の経過とともに傾向や変化に気づくことができるようになります。また、レビューにより、各ソースの信頼度の指標も得ることができます。  
（以下はrev.1日本語オリジナル）  
ログをレビューし、興味のあるエントリーを調査することは、事件を処理する準備にもなる。事件の処理では、これらのスキルが必要になる。　　
（ここまで）  

■ **ログ保持ポリシーの作成**  
インシデントに関する情報は、ファイアウォール、IDPS、アプリケーション ログなど、いくつかの場所に記録される可能性があります。ログデータの保持期間を指定したログ保持ポリシーを実装すると、古いログエントリには、偵察活動や以前に同様の攻撃が行われたことが示されている可能性があるため、分析に非常に役立つ可能性があります。ログを保持するもう一つの理由は、数日後、数週間後、あるいは数ヶ月後にならないとインシデントが発見されない可能性があることです。ログデータの保持期間は、組織のデータ保持ポリシーやデータ量など、いくつかの要因に依存します。ログに関する追加の推奨事項については、NIST SP 800-92「Guide to Computer Security Log Management」を参照してください。

■ **イベント相関処理の実施**  
インシデントの証拠は、異なるタイプのデータを含む複数のログに記録されることがあります。ファイアウォールログには使用されたソースIPアドレスが記録され、アプリケーションログにはユーザー名が記録されることがあります。ネットワーク IDPS は、特定のホストに対して攻撃が開始されたことを検出することができますが、攻撃の成否はわかりません。アナリストは、その情報を判断するためにホストのログを調べる必要があるかもしれません。複数の兆候ソース間のイベントを相関させることは、特定のインシデントが発生したかどうかを検証する上で非常に重要です。

■ **すべてのホストのクロックを同期**
NTP（Network Time Protocol）などのプロトコルは、ホスト間のクロックを同期させます。イベントを報告するデバイスのクロック設定が一貫していない場合、イベントの相関関係はより複雑になります。例えば、攻撃が12:07:01、12:10:35、11:07:06に発生したことを示すログよりも、証拠という観点から、攻撃が12:07:01に発生したことを示す3つのログを持つ（一貫したタイムスタンプがある）方が望ましいです。 

■ **情報のナレッジベースの維持・使用**  
ナレッジベースには、ハンドラーがインシデント分析時に素早く参照するために必要な情報が含まれている必要があります。複雑な構造のナレッジベースを構築することも可能ですが、シンプルなアプローチが効果的です。。テキスト文書、スプレッドシート、比較的シンプルなデータベースは、チームメンバー間でデータを共有するために効果的かつ柔軟性があり、検索可能なメカニズムを提供します。また、ナレッジベースには、IDPSアラート、オペレーティングシステムのログエントリ、アプリケーションのエラーコードなどの前兆や兆候の重要性や妥当性の説明など、さまざまな情報が含まれていることが望ましいです。 

■ **イベントの相関関係処理の実施**  
インターネット検索エンジンは、アナリストが、異常なアクティビティに関する情報を見つけるのに役立ちます。例えば、TCP ポート 22912 をターゲットにした異常な接続の試みをアナリストが目にすることがあります。「TCP」、「port」、および「22912」という用語で検索すると、類似のアクティビティのログや、ポート番号の重要性についての説明を含むいくつかのヒットが返ってくることがあります。これらの検索を行うことによる組織へのリスクを最小限に抑えるために、調査には別のワークステーションを使用すべきであることに注意してください。 
 
■ **パケットスニファを実行して追加データを収集**  
インジケータは、ハンドラーが何が起こっているのかを理解するのに十分な詳細を記録していないことがあります。インシデントがネットワーク上で発生している場合、必要なデータを収集する最速の方法は、パケットスニッファーにネットワークトラフィックをキャプチャさせることかもしれません。指定された基準に一致するトラフィックを記録するようにスニッファーを設定することで、データ量を管理可能な状態に保ち、他の情報を不用意に取得することを最小限に抑えることができます。プライバシーの問題があるため、組織によっては、パケットスニッファーを使用する前にインシデントハンドラーに要求して許可を得ることが必要とする場合があります。
 
■ **データのフィルタリング**  
すべての兆候を確認して分析するには、シンプルに十分な時間はありません。最低限、最も疑わしい活動を調査する必要があります。効果的な戦略の1つは、取るに足らない兆候のカテゴリーをフィルタリングすることです。もう一つのフィルタリング戦略は、最も重要度の高い兆候のカテゴリーのみを表示することです。しかしこの方法では、新たな悪意のある活動が、選択した兆候カテゴリのいずれかも該当しない可能性があるため、大きなリスクを伴います。

■ **他社の支援を求める**  
時として、チームはインシデントの完全な原因と性質を判断できないことがあります。チームがインシデントを封じ込め、根絶するための十分な情報が不足している場合は、内部のリソース（情報セキュリティスタッフなど）や外部のリソース（US-CERT、他のCSIRT、インシデント対応の専門知識を持つ請負業者など）に相談する必要があります。各インシデントの原因を正確に判断して、インシデントを完全に封じ込め、悪用された脆弱性を緩和して、同様のインシデントが発生しないようにすることが重要です。
 
 


 


 

 

 

